[2025-03-01T22:34:02.279+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: new_messages.lda_model manual__2025-03-01T22:25:27.102552+00:00 [queued]>
[2025-03-01T22:34:02.603+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: new_messages.lda_model manual__2025-03-01T22:25:27.102552+00:00 [queued]>
[2025-03-01T22:34:02.718+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2025-03-01T22:34:06.919+0000] {taskinstance.py:1382} INFO - Executing <Task(DockerOperator): lda_model> on 2025-03-01 22:25:27.102552+00:00
[2025-03-01T22:34:07.417+0000] {standard_task_runner.py:57} INFO - Started process 4589 to run task
[2025-03-01T22:34:07.486+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'new_messages', 'lda_model', 'manual__2025-03-01T22:25:27.102552+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/mess_cluster.py', '--cfg-path', '/tmp/tmpwn7s82ny']
[2025-03-01T22:34:08.073+0000] {standard_task_runner.py:85} INFO - Job 19: Subtask lda_model
[2025-03-01T22:34:09.047+0000] {task_command.py:416} INFO - Running <TaskInstance: new_messages.lda_model manual__2025-03-01T22:25:27.102552+00:00 [running]> on host d8e791698b86
[2025-03-01T22:34:10.104+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='new_messages' AIRFLOW_CTX_TASK_ID='lda_model' AIRFLOW_CTX_EXECUTION_DATE='2025-03-01T22:25:27.102552+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-03-01T22:25:27.102552+00:00'
[2025-03-01T22:34:11.595+0000] {docker.py:367} INFO - Starting docker container from image model-train:latest
[2025-03-01T22:35:22.318+0000] {docker.py:438} INFO - INFO:root:Подгружаем данные
[2025-03-01T22:35:22.328+0000] {docker.py:438} INFO - Traceback (most recent call last):
[2025-03-01T22:35:22.337+0000] {docker.py:438} INFO -   File "/workdir/TrainLDA.py", line 33, in <module>
[2025-03-01T22:35:22.338+0000] {docker.py:438} INFO -     train()
[2025-03-01T22:35:22.341+0000] {docker.py:438} INFO -   File "/usr/local/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[2025-03-01T22:35:22.346+0000] {docker.py:438} INFO - return self.main(*args, **kwargs)
[2025-03-01T22:35:22.378+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.396+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/click/core.py", line 1082, in main
[2025-03-01T22:35:22.413+0000] {docker.py:438} INFO - rv = self.invoke(ctx)
[2025-03-01T22:35:22.422+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.439+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[2025-03-01T22:35:22.458+0000] {docker.py:438} INFO - return ctx.invoke(self.callback, **ctx.params)
[2025-03-01T22:35:22.472+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.479+0000] {docker.py:438} INFO -   File "/usr/local/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[2025-03-01T22:35:22.491+0000] {docker.py:438} INFO - return __callback(*args, **kwargs)
[2025-03-01T22:35:22.506+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.513+0000] {docker.py:438} INFO - File "/workdir/TrainLDA.py", line 16, in train
[2025-03-01T22:35:22.515+0000] {docker.py:438} INFO - df = pd.read_csv(data_path)
[2025-03-01T22:35:22.519+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.521+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
[2025-03-01T22:35:22.524+0000] {docker.py:438} INFO - return _read(filepath_or_buffer, kwds)
[2025-03-01T22:35:22.525+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.527+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
[2025-03-01T22:35:22.529+0000] {docker.py:438} INFO - parser = TextFileReader(filepath_or_buffer, **kwds)
[2025-03-01T22:35:22.530+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.532+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
[2025-03-01T22:35:22.537+0000] {docker.py:438} INFO - self._engine = self._make_engine(f, self.engine)
[2025-03-01T22:35:22.539+0000] {docker.py:438} INFO - ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-03-01T22:35:22.541+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
[2025-03-01T22:35:22.557+0000] {docker.py:438} INFO - self.handles = get_handle(
[2025-03-01T22:35:22.582+0000] {docker.py:438} INFO - ^^^^^^^^^^^
[2025-03-01T22:35:22.613+0000] {docker.py:438} INFO - File "/usr/local/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
[2025-03-01T22:35:22.615+0000] {docker.py:438} INFO - handle = open(
[2025-03-01T22:35:22.619+0000] {docker.py:438} INFO -              ^^^^^
[2025-03-01T22:35:22.624+0000] {docker.py:438} INFO - FileNotFoundError: [Errno 2] No such file or directory: '/opt/***/data/raw/data__2025-03-01.csv'
[2025-03-01T22:35:24.061+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/docker/operators/docker.py", line 513, in execute
    return self._run_image()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/docker/operators/docker.py", line 384, in _run_image
    return self._run_image_with_mounts(self.mounts, add_tmp_variable=False)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/docker/operators/docker.py", line 446, in _run_image_with_mounts
    raise DockerContainerFailedException(f"Docker container failed: {result!r}", logs=log_lines)
airflow.providers.docker.exceptions.DockerContainerFailedException: Docker container failed: {'StatusCode': 1}
[2025-03-01T22:35:24.230+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=new_messages, task_id=lda_model, execution_date=20250301T222527, start_date=20250301T223402, end_date=20250301T223524
[2025-03-01T22:35:24.528+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 19 for task lda_model (Docker container failed: {'StatusCode': 1}; 4589)
[2025-03-01T22:35:24.618+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2025-03-01T22:35:24.915+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
